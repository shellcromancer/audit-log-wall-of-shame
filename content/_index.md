---
title: The Audit Log Wall of Shame
---

### Why does this exist?

Audit logs are a core resource for any blue team to successfully detect, investigate, or find behavioral patterns related to their organization. These audit logs are most commonly generated by external parties, such as SaaS vendors, hardware vendors, on-premise solution based companies etc.

Audit logs designed with security professionals in mind are critical to threat detection engineering and incident response. Considering their significance, vendors should be upheld to following core audit log practices.

The practices might fall into the buckets of:

- Data collection & its technical implementation
- Log quality & consistency
- Log content & documentation

Let's try to answer the question, how does a security engineer judge what qualifies as a "good" audit log? What do we need as professionals to effectively use these logs?

Here is an attempt to define an answer.

### Grading Scale
Log sources that are added will be graded from a scale of 0 - 9 with an associated lettering based on the Audit Log Quality Framework below.

- 10/10 A+
- 9/10 A
- 8/10 B+
- 7/10 B
- 6/10 C+
- 5/10 C
- 4/10 D+
- 3/10 D
- 2/10 F+
- 1/10 F
- 0/10 F-

#### Audit Log Quality Matrix Framework

*Log Content* (4pts)
- Event types cover all actions taken in the system and include critical fields, such as source ip address.
- Audit logs have external facing documentation on event types.
- Logs contain enough information to attribute activity to a user within the platform.
- The ability to get detailed audit logs is part of the core product or reasonably priced.

*Log Collection* (3pts)
- The ability exists to stream logs to a cloud storage or SIEM provider (such as logpush to S3). Otherwise the API to self-retrieve logs is straightforward, documented and allows engineers to easily retrieve their logs. 
- Log collection makes it possible for event IDs to be sorted and straightforward in order to not miss log events or get duplicate events in the pipeline.
- There is good log formatting and data structure choice, making it easy to parse logs once they are retrieved.

*Quality & Consistency* (3pts)
- There is log constistency across product versioning and operating systems, including when pulling the logs. Backwards compatability introduced when needed.
- Low rate of log quality related incidents. Logs are reliable and can be taken as a source of truth.
- There is limited latency between when an action occurs and when the log event is available.

### What are some examples of qualities that make a log “bad”?

- Lack of information to attribute activity to a user or IP address.
- Poor formatting and structure that makes it difficult to access required information.
-   Ex: Unordered arrays inside of nested JSON
-   Ex: Random dicts inside of variable length arrays so the same event may have mixed lengths.
- Different formats depending on which internal team built each event type.
- Inconsistent event type definitions based on how a user is accessing the system.
- Inconsistent formats and naming conventions that differ if you pull it via API or view it in the UI.

### So how do you write good logs?

This is a question I pose to the greater security community, this framework is open to suggestions and edits via the Github repository.


## References

1. [Creating Audit Logs for Security Professionsals](https://medium.com/@julieasparks/creating-audit-logs-for-security-professionals-2f81b4046bce)
2. [TBD](https://twitter.com)
